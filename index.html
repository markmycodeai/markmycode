<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarkMyCode - Competitive Programming Practice Platform</title>
    <!-- Google Fonts: Inter & JetBrains Mono -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <!-- add the logo -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">

    <!-- Design System -->
    <link rel="stylesheet" href="css/design-system.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/nexus-login.css">
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <!-- Navigation -->
    <nav>
        <div class="container">
            <div class="nav-brand">MarkMyCode</div>
            <ul class="nav-links">
                <li id="dashboardLink" class="hidden"><a href="#" data-nav="dashboard">Dashboard</a></li>
                <li id="adminLink" class="hidden"><a href="#" data-nav="admin">Admin Panel</a></li>
                <li id="collegeLink" class="hidden"><a href="#" data-nav="college">College</a></li>
                <li id="deptLink" class="hidden"><a href="#" data-nav="department">Department</a></li>
                <li id="batchLink" class="hidden"><a href="#" data-nav="batch">Batch</a></li>
                <li id="studentLink" class="hidden"><a href="#" data-nav="student">Practice</a></li>
                <li>
                    <button id="themeToggle" class="theme-switch" aria-label="Toggle Theme">
                        <div class="switch-track">
                            <div class="switch-handle">
                                <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="5" />
                                    <path
                                        d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" />
                                </svg>
                                <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                                </svg>
                            </div>
                        </div>
                    </button>
                </li>
                <li><button id="logoutBtn" class="btn btn-sm btn-secondary hidden">Logout</button></li>
            </ul>
        </div>
    </nav>

    <!-- Authentication Page (NexusGate Theme) -->
    <div id="authPage" class="nexus-container hidden">
        <!-- Video Background -->
        <div class="nexus-video-bg">
            <div class="nexus-video-overlay"></div>
            <video class="nexus-video-element" autoplay loop muted playsinline>
                <source src="css/BoyCoding.mp4" type="video/mp4">
            </video>
        </div>

        <!-- Glass Card -->
        <div class="nexus-card">

            <!-- Login Form -->
            <div id="loginForm">
                <div class="mb-8 text-center" style="margin-bottom: 2rem; text-align: center;">
                    <h2 class="nexus-title">
                        <span class="nexus-title-glow"></span>
                        <span style="position: relative;">MarkMyCode</span>
                    </h2>
                    <div class="nexus-subtitle">
                        <span class="nexus-subtitle-text">Master Data Structures & Algorithms</span>
                        <span class="nexus-subtitle-brackets">[System.out.println("Hello World")]</span>
                    </div>
                </div>

                <div class="space-y-6">
                    <!-- Email -->
                    <div class="nexus-input-group">
                        <div class="nexus-input-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <rect width="20" height="16" x="2" y="4" rx="2" />
                                <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7" />
                            </svg>
                        </div>
                        <input type="email" id="loginEmail" class="nexus-input" placeholder="Email address" required />
                    </div>

                    <!-- Password -->
                    <div class="nexus-input-group">
                        <div class="nexus-input-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <rect width="18" height="11" x="3" y="11" rx="2" ry="2" />
                                <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                            </svg>
                        </div>
                        <input type="password" id="loginPassword" class="nexus-input" placeholder="Password" required />
                        <button type="button"
                            onclick="const i = this.previousElementSibling; i.type = i.type === 'password' ? 'text' : 'password';"
                            style="position: absolute; right: 0.75rem; top: 50%; transform: translateY(-50%); color: rgba(255,255,255,0.6); cursor: pointer;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path
                                    d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0" />
                                <circle cx="12" cy="12" r="3" />
                            </svg>
                        </button>
                    </div>

                    <!-- Actions -->
                    <div class="nexus-actions">

                        <button type="button" class="nexus-link"
                            style="background: none; border: none; padding: 0; font: inherit; cursor: pointer;"
                            onclick="document.getElementById('passwordResetModal').classList.add('active'); document.getElementById('passwordResetModal').style.display = 'flex';">
                            Forgot password?
                        </button>
                    </div>

                    <!-- Submit -->
                    <button id="loginBtn" class="nexus-btn">
                        Start Coding
                    </button>
                </div>

                <!-- Footer / Register Toggle -->


                <p style="text-align: center; margin-top: 2rem; color: rgba(255,255,255,0.6); font-size: 0.875rem;">
                    Don't have an account?
                    <a href="#" id="toggleAuthForm" class="nexus-link" style="color: white; font-weight: 500;">Create
                        Account</a>
                </p>
                <div id="authMessage" style="margin-top: 1rem; text-align: center;"></div>
            </div>

            <!-- Register Form (Simple Inheritance) -->
            <div id="registerForm" class="hidden">
                <div class="mb-8 text-center" style="margin-bottom: 2rem; text-align: center;">
                    <h2 class="nexus-title">Join MarkMyCode</h2>
                    <p class="nexus-subtitle-text" style="color: rgba(255,255,255,0.8);">Commit to your future</p>
                </div>

                <div class="space-y-6">
                    <div class="nexus-input-group">
                        <input type="text" id="registerName" class="nexus-input" placeholder="Full Name" />
                    </div>
                    <div class="nexus-input-group">
                        <input type="email" id="registerEmail" class="nexus-input" placeholder="Email" />
                    </div>
                    <div class="nexus-input-group">
                        <input type="password" id="registerPassword" class="nexus-input" placeholder="Password" />
                    </div>

                    <div class="nexus-input-group">
                        <select id="registerRole" class="nexus-input" style="background-color: #0f172a;">
                            <!-- Dark bg for select options visibility -->
                            <option value="student">Student</option>
                            <option value="department">Department Admin</option>
                            <option value="college">College Admin</option>
                            <option value="admin">System Admin</option>
                        </select>
                    </div>

                    <button id="registerBtn" class="nexus-btn">Initialize Profile</button>
                </div>

                <p style="text-align: center; margin-top: 2rem;">
                    <a href="#"
                        onclick="document.getElementById('registerForm').classList.add('hidden'); document.getElementById('loginForm').classList.remove('hidden');"
                        class="nexus-link">Back to Login</a>
                </p>
                <div id="authMessage"></div>
            </div>

            <!-- Forgot Password Form -->
            <div id="forgotPasswordForm" class="hidden">
                <div class="mb-8 text-center" style="margin-bottom: 2rem; text-align: center;">
                    <h2 class="nexus-title">Reset Password</h2>
                    <p class="nexus-subtitle-text" style="color: rgba(255,255,255,0.8);">Enter your email to receive
                        reset instructions</p>
                </div>

                <div class="space-y-6">
                    <!-- Email Input -->
                    <div class="nexus-input-group">
                        <div class="nexus-input-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <rect width="20" height="16" x="2" y="4" rx="2" />
                                <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7" />
                            </svg>
                        </div>
                        <input type="email" id="forgotEmail" class="nexus-input" placeholder="Email address" required />
                    </div>

                    <!-- Submit Button -->
                    <button id="forgotPasswordBtn" class="nexus-btn">
                        Send Reset Email
                    </button>

                    <!-- Loading State -->
                    <div id="forgotLoadingState" class="hidden"
                        style="text-align: center; color: rgba(255,255,255,0.7);">
                        <p style="font-size: 0.875rem;">Sending reset link to your email...</p>
                    </div>

                    <!-- Success Message -->
                    <div id="forgotSuccessMessage" class="hidden"
                        style="background: rgba(34, 197, 94, 0.1); border: 1px solid #22c55e; border-radius: 0.5rem; padding: 1rem; text-align: center; color: #86efac;">
                        <p style="font-weight: 500;">Check your email!</p>
                        <p style="font-size: 0.875rem; margin-top: 0.5rem;">We've sent a password reset link to your
                            email address.</p>
                    </div>

                    <!-- Error Message -->
                    <div id="forgotErrorMessage" class="hidden"
                        style="background: rgba(239, 68, 68, 0.1); border: 1px solid #ef4444; border-radius: 0.5rem; padding: 1rem; text-align: center; color: #fca5a5;">
                    </div>
                </div>

                <p style="text-align: center; margin-top: 2rem;">
                    <a href="#"
                        onclick="document.getElementById('forgotPasswordForm').classList.add('hidden'); document.getElementById('loginForm').classList.remove('hidden'); return false;"
                        class="nexus-link">Back to Login</a>
                </p>
            </div>

            <!-- Loading Screen -->
            <div id="loaderScreen" class="hidden">
                <div class="nexus-loader">
                    <div class="nexus-spinner-container">
                        <div class="nexus-spinner-ring"></div>
                        <div class="nexus-spinner-ring"></div>
                        <div class="nexus-spinner-ring"></div>
                        <div class="nexus-core"></div>
                    </div>
                    <div class="nexus-loading-text" id="loadingText">Initializing...</div>
                    <div class="nexus-loading-subtext">Connecting to Secure Server</div>
                </div>
            </div>

        </div>
    </div>

    <!-- Main Application -->
    <main id="mainApp" class="hidden">
        <div class="container">
            <div id="pageMessage"></div>

            <!-- Dashboard Page -->
            <div id="dashboardPage" data-page="dashboard" class="hidden">
                <h1>Dashboard</h1>
                <div id="dashboardMessage"></div>
                <div id="dashboardContent"></div>
                <div id="activitySection"></div>
            </div>

            <!-- Admin Panel Page -->
            <div id="adminPage" data-page="admin" class="hidden">
                <h1>Admin Panel</h1>
                <div id="adminMessage"></div>

                <div class="tabs">
                    <button data-admin-tab="colleges" class="tab-btn active">Colleges</button>
                    <button data-admin-tab="departments" class="tab-btn">Departments</button>
                    <button data-admin-tab="batches" class="tab-btn">Batches</button>
                    <button data-admin-tab="students" class="tab-btn">Students</button>
                    <button data-admin-tab="topics" class="tab-btn">Topics</button>
                    <button data-admin-tab="questions" class="tab-btn">Questions</button>
                    <button data-admin-tab="notes" class="tab-btn">Notes</button>
                </div>

                <div style="margin-top: 1.5rem;">
                    <!-- Colleges -->
                    <div data-admin-content="colleges" style="display: block;">
                        <button class="btn btn-primary"
                            onclick="Admin.editingCollegeId = null; document.getElementById('collegeName').value = ''; document.querySelector('#collegeModal .modal-header h3').textContent = 'Add College'; document.querySelector('#collegeModal [type=submit]').textContent = 'Create College'; UI.openModal('collegeModal');">Add
                            College</button>
                        <div id="collegesList" style="margin-top: 1rem;"></div>
                    </div>

                    <!-- Departments -->
                    <div data-admin-content="departments" style="display: none;">
                        <button class="btn btn-primary" onclick="Admin.openAddDepartmentModal();">Add
                            Department</button>
                        <div id="departmentsList" style="margin-top: 1rem;"></div>
                    </div>

                    <!-- Batches -->
                    <div data-admin-content="batches" style="display: none;">
                        <button class="btn btn-primary" onclick="Admin.openAddBatchModal();">Add Batch</button>
                        <div id="batchesList" style="margin-top: 1rem;"></div>
                    </div>

                    <!-- Students -->
                    <div data-admin-content="students" style="display: none;">
                        <button class="btn btn-primary" onclick="Admin.openAddStudentModal();">Add Student</button>
                        <div id="adminStudentsList" style="margin-top: 1rem;"></div>
                    </div>

                    <!-- Topics -->
                    <div data-admin-content="topics" style="display: none;">
                        <button class="btn btn-primary" onclick="AdminTopics.openModal();">Add Topic</button>
                        <div id="adminTopicsList" style="margin-top: 1rem;"></div>
                    </div>

                    <!-- Questions -->
                    <div data-admin-content="questions" style="display: none;">
                        <div class="admin-questions-grid">
                            <!-- Questions List Panel -->
                            <div class="admin-panel">
                                <h3 class="admin-panel-header">Questions</h3>
                                <button class="btn btn-primary" onclick="Questions.openModal()"
                                    style="width: 100%; margin-bottom: 1rem;">+ Add Question</button>
                                <div id="adminQuestionsList" class="admin-panel-content"></div>
                            </div>

                            <!-- Question Edit Form Panel -->
                            <div class="admin-panel">
                                <h3 class="admin-panel-header">Edit Question</h3>
                                <div id="adminQuestionFormPanel" class="admin-panel-content">
                                    <div class="text-center text-secondary" style="padding-top: 2rem;">Select a question
                                        to edit</div>
                                </div>
                            </div>

                            <!-- Question Details Panel -->
                            <div class="admin-panel">
                                <h3 class="admin-panel-header">Details & Test Cases</h3>
                                <div id="adminQuestionDetailPanel" class="admin-panel-content">
                                    <div class="text-center text-secondary" style="padding-top: 2rem;">Select a question
                                        to view details</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notes -->
                    <div data-admin-content="notes" style="display: none;">
                        <button class="btn btn-primary" onclick="AdminNotes.openModal();">Add Note</button>
                        <div id="adminNotesList" style="margin-top: 1rem;"></div>
                    </div>
                </div>
            </div>

            <!-- College Page -->
            <div id="collegePage" data-page="college" class="hidden">
                <h1>College Dashboard</h1>
                <div id="collegeMessage"></div>
                <div id="collegePerformance"></div>

                <div class="tabs" style="margin-top: 2rem;">
                    <button data-college-tab="departments" class="tab-btn active">Departments</button>
                    <button data-college-tab="batches" class="tab-btn">Batches</button>
                    <button data-college-tab="students" class="tab-btn">Students</button>
                </div>

                <div style="margin-top: 1.5rem;">
                    <!-- Departments -->
                    <div data-college-content="departments" style="display: block;">
                        <div id="collegeDepartmentsList"></div>
                    </div>

                    <!-- Batches -->
                    <div data-college-content="batches" style="display: none;">
                        <div id="collegeBatchesList"></div>
                    </div>

                    <!-- Students -->
                    <div data-college-content="students" style="display: none;">
                        <div id="collegeStudentsList"></div>
                    </div>
                </div>
            </div>

            <!-- Department Page -->
            <div id="departmentPage" data-page="department" class="hidden">
                <h1>Department Dashboard</h1>
                <div id="departmentMessage"></div>

                <div class="tabs">
                    <button data-dept-tab="batches" class="tab-btn active">Batches</button>
                    <button data-dept-tab="students" class="tab-btn">Students</button>
                </div>

                <div style="margin-top: 1.5rem;">
                    <!-- Batches -->
                    <div data-dept-content="batches" style="display: block;">
                        <div id="departmentBatchesList"></div>
                    </div>

                    <!-- Students -->
                    <div data-dept-content="students" style="display: none;">
                        <div id="departmentStudentsList"></div>
                    </div>
                </div>
            </div>

            <!-- Batch Page -->
            <div id="batchPage" data-page="batch" class="hidden">
                <h1>Batch Dashboard</h1>
                <div id="batchMessage"></div>

                <div class="tabs">
                    <button data-batch-tab="students" class="tab-btn active">Students</button>
                    <button data-batch-tab="topics" class="tab-btn">Topics</button>
                    <button data-batch-tab="questions" class="tab-btn">Questions</button>
                    <button data-batch-tab="notes" class="tab-btn">Notes</button>
                </div>

                <div style="margin-top: 1.5rem;">
                    <!-- Students -->
                    <div data-batch-content="students" style="display: block;">
                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                            <button class="btn btn-primary" onclick="Batch.openAddStudentModal();">Add Student</button>
                            <button class="btn btn-success" onclick="Batch.openCSVModal();">Upload CSV</button>
                        </div>
                        <div id="batchStudentsList" style="margin-top: 1rem;"></div>
                    </div>

                    <!-- Topics -->
                    <div data-batch-content="topics" style="display: none;">
                        <button class="btn btn-primary" onclick="BatchTopics.openModal();">Add Topic</button>
                        <div id="batchTopicsList" style="margin-top: 1rem;"></div>
                    </div>

                    <!-- Questions -->
                    <!-- Questions -->
                    <div data-batch-content="questions" style="display: none;">
                        <div class="admin-questions-grid">
                            <!-- Column 1: List -->
                            <div class="admin-panel" id="batchQuestionsListPanel">
                                <h3 class="admin-panel-header">Questions</h3>
                                <button class="btn btn-primary" onclick="Questions.prepareCreate()"
                                    style="width: 100%; margin-bottom: 1rem;">+ Add Question</button>
                                <div id="batchQuestionsList" class="admin-panel-content">
                                    <!-- Questions List Loaded Here -->
                                </div>
                            </div>

                            <!-- Column 2: Edit Form -->
                            <div class="admin-panel" id="batchQEditPanel">
                                <h3 class="admin-panel-header">Edit Question</h3>
                                <div class="admin-panel-content" id="batchQEditForm">
                                    <div class="text-center text-muted" style="padding: 2rem;">Select a question to edit
                                    </div>
                                </div>
                            </div>

                            <!-- Column 3: Details / Test Cases -->
                            <div class="admin-panel" id="batchQDetailsPanel">
                                <h3 class="admin-panel-header">Details & Test Cases</h3>
                                <div class="admin-panel-content" id="batchQDetailsContent">
                                    <div class="text-center text-muted" style="padding: 2rem;">Select a question to view
                                        details</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notes -->
                    <div data-batch-content="notes" style="display: none;">
                        <button class="btn btn-primary" onclick="BatchNotes.openModal();">Add Note</button>
                        <div id="batchNotesList" style="margin-top: 1rem;"></div>
                    </div>
                </div>
            </div>

            <!-- Student Practice Page -->
            <div id="studentPage" data-page="student" class="hidden">
                <h1>Practice Questions</h1>
                <div id="practiceMessage"></div>

                <!-- Tabs for Practice and Notes -->
                <div style="display: flex; gap: 0; border-bottom: 2px solid #ddd; margin-bottom: 1rem;">
                    <button class="btn btn-sm"
                        style="padding: 0.75rem 1.5rem; border: none; border-bottom: 3px solid #007bff; background: transparent; cursor: pointer; font-weight: bold; color: #007bff;"
                        onclick="StudentPractice.switchTab('practice')">
                        Practice
                    </button>
                    <button class="btn btn-sm"
                        style="padding: 0.75rem 1.5rem; border: none; border-bottom: 3px solid transparent; background: transparent; cursor: pointer; font-weight: bold; color: #666;"
                        onclick="StudentPractice.switchTab('notes')" id="notesTabBtn">
                        Study Notes
                    </button>
                </div>

                <!-- Debugging: Student Hierarchy Display -->
                <div id="studentHierarchy"
                    style="background: #f0f0f0; padding: 1rem; margin-bottom: 1rem; border-radius: 4px; border-left: 4px solid #007bff;">
                    <strong style="color: #333;">Your Profile:</strong>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-top: 0.5rem;">
                        <div>
                            <span style="font-size: 0.85rem; color: #666;">College:</span>
                            <p id="collegeDisplay" style="margin: 0.25rem 0 0 0; font-weight: bold; color: #333;">-</p>
                        </div>
                        <div>
                            <span style="font-size: 0.85rem; color: #666;">Department:</span>
                            <p id="departmentDisplay" style="margin: 0.25rem 0 0 0; font-weight: bold; color: #333;">-
                            </p>
                        </div>
                        <div>
                            <span style="font-size: 0.85rem; color: #666;">Batch:</span>
                            <p id="batchDisplay" style="margin: 0.25rem 0 0 0; font-weight: bold; color: #333;">-</p>
                        </div>
                        <div>
                            <span style="font-size: 0.85rem; color: #666;">Student ID:</span>
                            <p id="studentIdDisplay" style="margin: 0.25rem 0 0 0; font-weight: bold; color: #333;">-
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Practice Tab Content -->
                <div id="practiceTabContent" class="practice-container">

                    <!-- PHASE 1: Topics Selection -->
                    <div id="topicsPhasePanel" style="display: flex; flex-direction: column; height: 100%;">
                        <div class="phase-header">
                            <div>
                                <h2 style="margin: 0; color: var(--text-main);">Select a Topic</h2>
                                <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary);">Choose a topic to begin
                                    practicing</p>
                            </div>
                        </div>
                        <div class="phase-content">
                            <div id="studentTopicsList"></div>
                        </div>
                    </div>

                    <!-- PHASE 2: Questions Selection -->
                    <div id="questionsPhasePanel" style="display: none; flex-direction: column; height: 100%;">
                        <div class="phase-header">
                            <div>
                                <h2 style="margin: 0; color: var(--text-main);">Select a Question</h2>
                                <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary);">Choose a question to
                                    solve</p>
                            </div>
                            <button id="backToTopicsBtn" class="btn btn-secondary"
                                onclick="StudentPractice.goBackToTopics()">Back to Topics</button>
                        </div>
                        <div class="phase-content">
                            <div id="studentQuestionsList"></div>
                        </div>
                    </div>

                    <!-- PHASE 3: Code Editor -->
                    <div id="editorPhasePanel" style="display: none; flex-direction: column; height: 100%;">
                        <div id="editorHeader" class="phase-header"
                            style="background: #262626; color: #fff; border-bottom: 1px solid #333; padding: 0.75rem 1.5rem;">
                            <div>
                                <h2 id="problemTitle"
                                    style="margin: 0; margin-bottom: 0.25rem; font-size: 1.15rem; color: #fff;">
                                    Select a Question</h2>
                                <div id="problemDifficulty" style="color: #aaa; font-size: 0.85rem;">No question
                                    selected</div>
                            </div>
                            <button id="backToQuestionsBtn" class="btn btn-secondary"
                                style="background: #333; color: white; border: 1px solid #444;"
                                onclick="StudentPractice.goBackToQuestions()">Back to Questions</button>
                        </div>

                        <!-- Problem Statement & Editor Container -->
                        <div id="problemEditorContainer" class="editor-grid">

                            <!-- Left Pane: Problem Description -->
                            <div id="problemSection" class="problem-panel">
                                <div class="problem-header-tabs">
                                    <div class="problem-tab active" id="tabDescription"
                                        onclick="StudentPractice.switchProblemTab('description')">Description</div>
                                    <div class="problem-tab" id="tabSubmissions"
                                        onclick="StudentPractice.switchProblemTab('submissions')">Submissions</div>
                                </div>
                                <div class="problem-content">
                                    <!-- Description Tab Content -->
                                    <div id="descriptionContent">
                                        <h3 style="margin-top: 0; margin-bottom: 1rem;">Problem Statement</h3>
                                        <div id="problemDescription" style="line-height: 1.6; margin-bottom: 1.5rem;">
                                        </div>

                                        <h3 style="margin-top: 1.5rem; margin-bottom: 1rem;">Example</h3>
                                        <div
                                            style="display: grid; grid-template-columns: 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                                            <div class="card"
                                                style="padding: 1rem; background: #333; border: 1px solid #444;">
                                                <h4 style="margin: 0 0 0.5rem 0; color: #aaa; font-size:0.9rem;">Input
                                                </h4>
                                                <pre id="exampleInput"
                                                    style="margin: 0; font-family: 'JetBrains Mono'; font-size: 0.85rem; padding: 0.5rem; background: transparent; color: #e0e0e0;"></pre>
                                            </div>
                                            <div class="card"
                                                style="padding: 1rem; background: #333; border: 1px solid #444;">
                                                <h4 style="margin: 0 0 0.5rem 0; color: #aaa; font-size:0.9rem;">Output
                                                </h4>
                                                <pre id="exampleOutput"
                                                    style="margin: 0; font-family: 'JetBrains Mono'; font-size: 0.85rem; padding: 0.5rem; background: transparent; color: #e0e0e0;"></pre>
                                            </div>
                                        </div>

                                        <div id="constraintsSection" style="display: none;">
                                            <h3 style="margin-top: 1.5rem; margin-bottom: 1rem;">Constraints</h3>
                                            <div id="constraints" class="card"
                                                style="padding: 1rem; background: #333; border: 1px solid #444;"></div>
                                        </div>
                                    </div>

                                    <!-- Submissions Tab Content -->
                                    <div id="submissionsContent" style="display: none;">
                                        <div id="submissionResultDisplay"
                                            style="text-align: center; padding: 2rem; color: #aaa;">
                                            No recent submissions
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Pane: Code & Console -->
                            <div id="editorSection" class="code-panel">

                                <!-- Top Half: Code Editor -->
                                <div id="editorContainer" class="code-editor-section">
                                    <div class="editor-toolbar">
                                        <div style="display: flex; align-items: center; gap: 1rem; color: #bbb;">
                                            <select id="languageSelect"
                                                onchange="StudentPractice.changeLanguage(this.value)"
                                                style="background: #333; color: white; border: 1px solid #444; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.85rem;">
                                                <option value="python">Python</option>
                                                <option value="java">Java</option>
                                                <option value="cpp">C++</option>
                                                <option value="c">C</option>
                                                <option value="javascript">JavaScript</option>
                                            </select>
                                        </div>
                                        <div style="display: flex; gap: 0.5rem;">
                                            <button class="btn btn-primary" id="runBtn"
                                                style="padding: 0.3rem 0.8rem; font-size: 0.85rem;"
                                                onclick="StudentPractice.runCode()">Run</button>
                                            <button class="btn btn-success" id="submitBtn"
                                                style="padding: 0.3rem 0.8rem; font-size: 0.85rem;"
                                                onclick="StudentPractice.submitCode()">Submit</button>
                                            <button class="btn btn-info" id="analyzeEfficiencyBtn"
                                                style="display: none; padding: 0.3rem 0.8rem; font-size: 0.85rem;"
                                                onclick="StudentPractice.analyzeEfficiency()">Analyze</button>
                                        </div>
                                    </div>
                                    <textarea id="codeEditor" class="code-textarea" spellcheck="false"
                                        placeholder="# Write your solution here..."></textarea>
                                </div>

                                <!-- Bottom Half: Console (Test Cases / Results) -->
                                <div class="console-section">
                                    <div class="console-header">
                                        <div class="console-tabs">
                                            <div class="console-tab active" id="tabTestcase"
                                                onclick="StudentPractice.switchConsoleTab('testcase')">Testcase</div>
                                            <div class="console-tab" id="tabResult"
                                                onclick="StudentPractice.switchConsoleTab('result')">Test Result</div>
                                        </div>
                                    </div>

                                    <div class="console-content">
                                        <!-- Testcase View -->
                                        <div id="viewTestcase">
                                            <div style="background: #2d2d2d; padding: 1rem; border-radius: 6px;">
                                                <div style="margin-bottom: 1rem;">
                                                    <label
                                                        style="display: block; margin-bottom: 0.5rem; color: #aaa; font-size: 0.85rem;">Input</label>
                                                    <textarea id="customInput" class="code-textarea"
                                                        style="height: 60px; background: #3e3e3e; border: 1px solid #555; border-radius: 4px; color: #fff;"></textarea>
                                                </div>
                                                <div style="margin-bottom: 1rem;">
                                                    <label
                                                        style="display: block; margin-bottom: 0.5rem; color: #aaa; font-size: 0.85rem;">Expected
                                                        Output (Optional)</label>
                                                    <textarea id="customOutput" class="code-textarea"
                                                        style="height: 60px; background: #3e3e3e; border: 1px solid #555; border-radius: 4px; color: #fff;"></textarea>
                                                </div>
                                                <div>
                                                    <button class="btn btn-sm btn-secondary"
                                                        style="background: #444; color: #fff; border: 1px solid #555;"
                                                        onclick="StudentPractice.addCustomTestCase()">+ Add
                                                        Case</button>
                                                </div>
                                            </div>
                                            <div id="customTestCasesList" style="margin-top: 1rem; display: none;">
                                            </div>
                                        </div>

                                        <!-- Result View -->
                                        <div id="viewResult" style="display: none;">
                                            <div id="testResults" style="color: #ccc;">
                                                <div style="padding: 2rem; text-align: center; color: #666;">
                                                    Run your code to see results here.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Notes Tab Content -->
                <div id="notesTabContent" style="display: none; padding-top: 2rem;">
                    <div style="max-width: 1200px;"> <!-- Increased width for grid -->
                        <div style="margin-bottom: 2rem;">
                            <h2 style="margin: 0; color: var(--text-main);">Study Notes</h2>
                            <p style="margin: 0.5rem 0 0 0; color: var(--text-secondary);">Resources for your batch</p>
                        </div>
                        <div id="studentNotesList"></div>
                    </div>
                </div>
            </div>
            <!-- End of studentPage (effectively) -->

    </main>

    <!-- Modals -->

    <!-- Question Modal for Admin -->
    <div id="questionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Question</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                <input type="hidden" id="questionId" />

                <!-- Step 1: Hierarchy Selection (Admin Only) -->
                <div id="questionHierarchyStep" style="display: none;">
                    <h4 style="margin-bottom: 1rem; color: #333;">Select Hierarchy</h4>

                    <div class="form-group">
                        <label>College: <span style="color: red;">*</span></label>
                        <select id="questionCollege" required onchange="Questions.loadDepartments(this.value)">
                            <option value="">-- Select College --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Department: <span style="color: red;">*</span></label>
                        <select id="questionDepartment" required onchange="Questions.loadBatches(this.value)">
                            <option value="">-- Select Department --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Batch: <span style="color: red;">*</span></label>
                        <select id="questionBatch" required onchange="Questions.loadTopics(this.value)">
                            <option value="">-- Select Batch --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Topic: <span style="color: red;">*</span></label>
                        <select id="questionTopic" required>
                            <option value="">-- Select Topic --</option>
                        </select>
                    </div>

                    <div style="border-top: 1px solid #ddd; padding-top: 1rem; margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="Questions.proceedToQuestionDetails()"
                            style="width: 100%;">Next: Add Question Details</button>
                    </div>
                </div>

                <!-- Step 2: Question Details -->
                <div id="questionDetailsStep" style="display: none;">
                    <h4 style="margin-bottom: 1rem; color: #333;">Question Details</h4>

                    <div class="form-group">
                        <label>Title: <span style="color: red;">*</span></label>
                        <input type="text" id="questionTitle" required placeholder="Question title (min 3 chars)" />
                    </div>

                    <div class="form-group">
                        <label>Description: <span style="color: red;">*</span></label>
                        <textarea id="questionDescription" rows="4" required
                            placeholder="Detailed problem description (min 10 chars)"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Sample Input: <span style="color: red;">*</span></label>
                        <textarea id="questionSampleInput" rows="3" required
                            placeholder="Example input data"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Sample Output: <span style="color: red;">*</span></label>
                        <textarea id="questionSampleOutput" rows="3" required
                            placeholder="Expected output for sample input"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Difficulty:</label>
                        <select id="questionDifficulty">
                            <option value="Easy">Easy</option>
                            <option value="Medium" selected>Medium</option>
                            <option value="Hard">Hard</option>
                        </select>
                    </div>

                    <div id="questionsMessage"></div>

                    <div
                        style="border-top: 1px solid #ddd; padding-top: 1rem; margin-top: 1rem; display: flex; gap: 0.5rem;">
                        <button class="btn btn-secondary" onclick="Questions.backToHierarchy()"
                            style="flex: 1;">Back</button>
                        <button class="btn btn-primary" onclick="Questions.save()" style="flex: 1;">Create
                            Question</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Note Modal -->
    <div id="noteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Note</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="noteId" />
                <div class="form-group">
                    <label>Topic:</label>
                    <select id="noteTopic" required></select>
                </div>
                <div class="form-group">
                    <label>Title:</label>
                    <input type="text" id="noteTitle" required />
                </div>
                <div class="form-group">
                    <label>Google Drive Link:</label>
                    <input type="url" id="noteLink" required />
                </div>
                <div id="notesMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('noteModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="Notes.save()">Create Note</button>
            </div>
        </div>
    </div>

    <!-- Student Modal -->
    <div id="studentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Student</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="studentId" />
                <div class="form-group">
                    <label>College:</label>
                    <select id="studentCollege" required onchange="Admin.onStudentCollegeChange()"></select>
                </div>
                <div class="form-group">
                    <label>Department:</label>
                    <select id="studentDepartment" required disabled
                        onchange="Admin.onStudentDepartmentChange()"></select>
                </div>
                <div class="form-group">
                    <label>Batch:</label>
                    <select id="studentBatch" required disabled></select>
                </div>
                <div class="form-group">
                    <label>Username:</label>
                    <input type="text" id="studentUsername" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="studentEmail" required />
                </div>
                <div class="form-group" id="studentPassword">
                    <label>Password:</label>
                    <input type="password" id="studentPasswordInput" />
                </div>
                <div id="studentsMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('studentModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="Admin.saveStudent()">Create Student</button>
            </div>
        </div>
    </div>

    <!-- College Modal -->
    <div id="collegeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add College</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="collegeId" />
                <div class="form-group">
                    <label>Name:</label>
                    <input type="text" id="collegeName" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="collegeEmail" required />
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="collegePassword" required />
                </div>
                <div id="collegesMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('collegeModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="Admin.saveCollege()">Create College</button>
            </div>
        </div>
    </div>

    <!-- Department Modal (for admin) -->
    <div id="departmentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Department</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="departmentId" />
                <div class="form-group">
                    <label>College:</label>
                    <select id="departmentCollege" required></select>
                </div>
                <div class="form-group">
                    <label>Name:</label>
                    <input type="text" id="departmentName" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="departmentEmail" required />
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="departmentPassword" required />
                </div>
                <div id="departmentsMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('departmentModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="Admin.saveDepartment()">Create
                    Department</button>
            </div>
        </div>
    </div>

    <!-- Batch Modal -->
    <div id="batchModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Batch</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="batchId" />
                <div class="form-group">
                    <label>College:</label>
                    <select id="batchCollege" required onchange="Admin.onBatchCollegeChange()"></select>
                </div>
                <div class="form-group">
                    <label>Department:</label>
                    <select id="batchDepartment" required disabled></select>
                </div>
                <div class="form-group">
                    <label>Name:</label>
                    <input type="text" id="batchName" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="batchEmail" required />
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="batchPassword" required />
                </div>
                <div id="batchesMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('batchModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="Admin.saveBatch()">Create Batch</button>
            </div>
        </div>
    </div>

    <!-- Topic Modal -->
    <div id="topicModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Topic</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="topicId" />
                <div class="form-group">
                    <label>Name:</label>
                    <input type="text" id="topicName" required />
                </div>
                <div class="form-group">
                    <label>Description:</label>
                    <textarea id="topicDescription" rows="4"></textarea>
                </div>
                <div id="topicsMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('topicModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="Department.saveTopic()">Create Topic</button>
            </div>
        </div>
    </div>

    <!-- College Department Modal -->
    <div id="collegeDepartmentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Department</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Name:</label>
                    <input type="text" id="collegeDepartmentName" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="collegeDepartmentEmail" required />
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="collegeDepartmentPassword" required />
                </div>
                <div id="collegeDepartmentMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('collegeDepartmentModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="College.saveDepartment()">Create
                    Department</button>
            </div>
        </div>
    </div>

    <!-- College Batch Modal -->
    <div id="collegeBatchModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Batch</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Department:</label>
                    <select id="collegeBatchDepartment" required></select>
                </div>
                <div class="form-group">
                    <label>Batch Name:</label>
                    <input type="text" id="collegeBatchName" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="collegeBatchEmail" required />
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="collegeBatchPassword" required />
                </div>
                <div id="collegeBatchMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('collegeBatchModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="College.saveBatch()">Create Batch</button>
            </div>
        </div>
    </div>

    <!-- College Student Modal -->
    <div id="collegeStudentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Student</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Department:</label>
                    <select id="collegeStudentDepartment" onchange="College.onCollegeStudentDepartmentChange()"
                        required></select>
                </div>
                <div class="form-group">
                    <label>Batch:</label>
                    <select id="collegeStudentBatch" required></select>
                </div>
                <div class="form-group">
                    <label>Username:</label>
                    <input type="text" id="collegeStudentUsername" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="collegeStudentEmail" required />
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="collegeStudentPassword" required />
                </div>
                <div id="collegeStudentMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('collegeStudentModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="College.saveStudent()">Create Student</button>
            </div>
        </div>
    </div>

    <!-- Department Batch Modal -->
    <div id="departmentBatchModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Batch</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Batch Name:</label>
                    <input type="text" id="departmentBatchName" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="departmentBatchEmail" required />
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="departmentBatchPassword" required />
                </div>
                <div id="departmentBatchMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('departmentBatchModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="Department.saveBatch()">Create Batch</button>
            </div>
        </div>
    </div>

    <!-- Department Student Modal -->
    <div id="departmentStudentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Student</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Batch:</label>
                    <select id="departmentStudentBatch" required></select>
                </div>
                <div class="form-group">
                    <label>Username:</label>
                    <input type="text" id="departmentStudentUsername" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="departmentStudentEmail" required />
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="departmentStudentPassword" required />
                </div>
                <div id="departmentStudentMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('departmentStudentModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="Department.saveStudent()">Create Student</button>
            </div>
        </div>
    </div>

    <!-- Batch Student Modal -->
    <div id="batchStudentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Student</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="batchStudentId" />
                <div class="form-group">
                    <label>Name:</label>
                    <input type="text" id="batchStudentName" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="batchStudentEmail" required />
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="password" id="batchStudentPassword" required />
                </div>
                <div id="batchStudentsMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('batchStudentModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="Batch.saveStudent()">Create Student</button>
            </div>
        </div>
    </div>

    <!-- CSV Upload Modal -->
    <div id="csvModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upload Students from CSV</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>CSV File (Name, Email, Password columns required):</label>
                    <input type="file" id="csvFile" accept=".csv" required />
                </div>
                <div style="margin: 1rem 0; padding: 1rem; background: #f0f0f0; border-radius: 4px;">
                    <strong>CSV Format Example:</strong>
                    <pre>Name,Email,Password
John Doe,john@example.com,password123
Jane Smith,jane@example.com,password456</pre>
                </div>
                <div id="csvMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('csvModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="Batch.uploadCSV()">Upload</button>
            </div>
        </div>
    </div>

    <!-- Batch Topic Modal -->
    <div id="batchTopicModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Topic</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="batchTopicId" />
                <div class="form-group">
                    <label>Topic Name: <span style="color: red;">*</span></label>
                    <input type="text" id="batchTopicName" required placeholder="Topic name (min 2 chars)" />
                </div>
                <div id="batchTopicsMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('batchTopicModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="BatchTopics.save()">Create Topic</button>
            </div>
        </div>
    </div>

    <!-- Batch Note Modal -->
    <div id="batchNoteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Note</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="batchNoteId" />
                <div class="form-group">
                    <label>Title: <span style="color: red;">*</span></label>
                    <input type="text" id="batchNoteTitle" required placeholder="Note title (min 2 chars)" />
                </div>
                <div class="form-group">
                    <label>Google Drive Link: <span style="color: red;">*</span></label>
                    <input type="url" id="batchNoteLink" required placeholder="https://drive.google.com/..." />
                </div>
                <div id="batchNotesMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('batchNoteModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="BatchNotes.save()">Create Note</button>
            </div>
        </div>
    </div>

    <!-- Batch Question Modal -->
    <div id="batchQuestionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="batchQuestionModalTitle">Add Question</h3>
                <button class="close-btn" onclick="UI.closeModal('batchQuestionModal')">&times;</button>
            </div>
            <div class="modal-body" style="max-height: 70vh; overflow-y: auto;">
                <input type="hidden" id="batchQuestionId" />

                <div class="form-group">
                    <label>Topic: <span style="color: red;">*</span></label>
                    <select id="batchQuestionTopic" required></select>
                </div>

                <div class="form-group">
                    <label>Title: <span style="color: red;">*</span></label>
                    <input type="text" id="batchQuestionTitle" required placeholder="Enter question title"
                        style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;" />
                </div>

                <div class="form-group">
                    <label>Description: <span style="color: red;">*</span></label>
                    <textarea id="batchQuestionDescription" required placeholder="Enter question description"
                        style="min-height: 100px;"></textarea>
                </div>

                <div class="form-group">
                    <label>Sample Input: <span style="color: red;">*</span></label>
                    <textarea id="batchQuestionSampleInput" required placeholder="Enter sample input"
                        style="min-height: 80px;"></textarea>
                </div>

                <div class="form-group">
                    <label>Sample Output: <span style="color: red;">*</span></label>
                    <textarea id="batchQuestionSampleOutput" required placeholder="Enter sample output"
                        style="min-height: 80px;"></textarea>
                </div>

                <div id="batchQuestionsMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('batchQuestionModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="BatchQuestions.save()">Create Question</button>
            </div>
        </div>
    </div>

    <!-- Admin Topic Modal -->
    <div id="adminTopicModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Topic</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="adminTopicId" />

                <div class="form-group">
                    <label>College: <span style="color: red;">*</span></label>
                    <select id="adminTopicCollege" required onchange="AdminTopics.loadDepartments(this.value)"></select>
                </div>

                <div class="form-group">
                    <label>Department: <span style="color: red;">*</span></label>
                    <select id="adminTopicDepartment" required onchange="AdminTopics.loadBatches(this.value)"></select>
                </div>

                <div class="form-group">
                    <label>Batch: <span style="color: red;">*</span></label>
                    <select id="adminTopicBatch" required></select>
                </div>

                <hr style="margin: 1rem 0;">

                <div class="form-group">
                    <label>Topic Name: <span style="color: red;">*</span></label>
                    <input type="text" id="adminTopicName" required placeholder="Topic name (min 2 chars)" />
                </div>
                <div id="adminTopicsMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('adminTopicModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="AdminTopics.save()">Create Topic</button>
            </div>
        </div>
    </div>

    <!-- Password Reset Modal -->
    <div id="passwordResetModal" class="modal" style="z-index: 10001;">
        <div class="modal-content" style="background: #1e1e1e; border: 1px solid #333; color: #e0e0e0;">
            <div class="modal-header" style="border-bottom: 1px solid #333;">
                <h3 style="color: #fff;">Reset Password</h3>
                <button class="close-btn"
                    onclick="document.getElementById('passwordResetModal').classList.remove('active'); setTimeout(() => document.getElementById('passwordResetModal').style.display='none', 200);"
                    style="color: #aaa; cursor: pointer;">&times;</button>
            </div>
            <div class="modal-body">
                <p style="color: #aaa; margin-bottom: 1rem; font-size: 0.9rem;">Enter your email address and we'll send
                    you a link to reset your password.</p>
                <div class="form-group">
                    <label style="color: #ccc;">Email Address:</label>
                    <input type="email" id="resetEmailInput" class="nexus-input"
                        style="width: 100%; padding: 0.75rem; background: #2d2d2d; border: 1px solid #444; color: white;"
                        placeholder="name@example.com" />
                </div>
                <div id="resetMessage" style="margin-top: 1rem; font-size: 0.9rem;"></div>
            </div>
            <div class="modal-footer" style="border-top: 1px solid #333;">
                <button class="btn btn-secondary"
                    onclick="document.getElementById('passwordResetModal').classList.remove('active'); setTimeout(() => document.getElementById('passwordResetModal').style.display='none', 200);"
                    style="background: #333; color: white; border: 1px solid #444;">Cancel</button>
                <button class="btn btn-primary" id="sendResetBtn" onclick="sendPasswordReset()">Send Link</button>
            </div>
        </div>
    </div>

    <!-- Admin Note Modal -->
    <div id="adminNoteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Note</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="adminNoteId" />

                <div class="form-group">
                    <label>College: <span style="color: red;">*</span></label>
                    <select id="adminNoteCollege" required onchange="AdminNotes.loadDepartments(this.value)"></select>
                </div>

                <div class="form-group">
                    <label>Department: <span style="color: red;">*</span></label>
                    <select id="adminNoteDepartment" required onchange="AdminNotes.loadBatches(this.value)"></select>
                </div>

                <div class="form-group">
                    <label>Batch: <span style="color: red;">*</span></label>
                    <select id="adminNoteBatch" required></select>
                </div>

                <hr style="margin: 1rem 0;">

                <div class="form-group">
                    <label>Title: <span style="color: red;">*</span></label>
                    <input type="text" id="adminNoteTitle" required placeholder="Note title (min 2 chars)" />
                </div>
                <div class="form-group">
                    <label>Google Drive Link: <span style="color: red;">*</span></label>
                    <input type="url" id="adminNoteLink" required placeholder="https://drive.google.com/..." />
                </div>
                <div id="adminNotesMessage"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="UI.closeModal('adminNoteModal')">Cancel</button>
                <button class="btn btn-primary" type="submit" onclick="AdminNotes.save()">Create Note</button>
            </div>
        </div>
    </div>

    <!-- Monaco Editor Loader -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs/loader.min.js"></script>
    <script>
        // Configure Monaco Loader
        require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.36.1/min/vs' } });
        // Eagerly load the main editor module so it's ready when needed
        require(['vs/editor/editor.main'], function () {
            console.log('Monaco Editor loaded successfully');
            window.monacoLoaded = true;
        });
    </script>

    <!-- Scripts - Load in correct order -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/questions-rbac.js"></script>
    <script src="js/notes.js"></script>
    <script src="js/students.js"></script>
    <script src="js/student-profile.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/admin-topics.js"></script>
    <script src="js/admin-notes.js"></script>
    <script src="js/college.js"></script>
    <script src="js/department.js"></script>
    <script src="js/batch.js"></script>
    <script src="js/batch-topics.js"></script>

    <script src="js/batch-notes.js"></script>
    <script src="js/student.js"></script>
    <script>
        async function sendPasswordReset() {
            const emailInput = document.getElementById('resetEmailInput');
            const messageEl = document.getElementById('resetMessage');
            const btn = document.getElementById('sendResetBtn');

            const email = emailInput.value.trim();
            if (!email) {
                messageEl.textContent = 'Please enter your email address.';
                messageEl.style.color = '#ff6b6b';
                return;
            }

            try {
                btn.disabled = true;
                btn.textContent = 'Sending...';
                messageEl.textContent = '';

                await Auth.requestPasswordReset(email);

                messageEl.textContent = 'Reset link sent! Check your inbox.';
                messageEl.style.color = '#4ade80';

                // Close after 2 seconds
                setTimeout(() => {
                    document.getElementById('passwordResetModal').style.display = 'none';
                    btn.disabled = false;
                    btn.textContent = 'Send Link';
                    emailInput.value = '';
                    messageEl.textContent = '';
                }, 2000);

            } catch (error) {
                console.error(error);
                btn.disabled = false;
                btn.textContent = 'Send Link';
                messageEl.textContent = error.message || 'Failed to send reset link.';
                messageEl.style.color = '#ff6b6b';
            }
        }
    </script>
    <script src="js/ui.js"></script>
</body>

</html>